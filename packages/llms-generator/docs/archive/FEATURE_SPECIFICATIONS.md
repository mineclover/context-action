# ì´ë¦„ ì¤‘ë³µ ì²˜ë¦¬ ì‹œìŠ¤í…œ - ê¸°ëŠ¥ ëª…ì„¸ì„œ

## ğŸ“‹ **ì‹œìŠ¤í…œ ê°œìš”**

LLMS Generatorì˜ priority.json íŒŒì¼ ê´€ë¦¬ ì‹œ ë°œìƒí•  ìˆ˜ ìˆëŠ” ID ì¤‘ë³µì„ ì²´ê³„ì ìœ¼ë¡œ íƒì§€í•˜ê³  í•´ê²°í•˜ëŠ” ì‹œìŠ¤í…œì…ë‹ˆë‹¤.

### **ë²„ì „**: 1.0.0
### **ìµœì¢… ì—…ë°ì´íŠ¸**: 2025-08-16
### **ë‹´ë‹¹ ëª¨ë“ˆ**: `work-queue-cli.cjs`, `wq` (ë˜í¼ ìŠ¤í¬ë¦½íŠ¸)

---

## ğŸ¯ **í•µì‹¬ ê¸°ëŠ¥ (Core Features)**

### **1. ì¤‘ë³µ íƒì§€ ì‹œìŠ¤í…œ (Duplicate Detection)**

#### **1.1 íƒì§€ ë²”ìœ„**
- **ì–¸ì–´ë³„ ì¤‘ë³µ**: ë™ì¼ ì–¸ì–´ ë‚´ ID ì¶©ëŒ ê²€ì‚¬
- **íŒŒì¼ì‹œìŠ¤í…œ ì¶©ëŒ**: ëŒ€ì†Œë¬¸ì êµ¬ë¶„ ì—†ëŠ” ì‹œìŠ¤í…œì—ì„œì˜ ì¶©ëŒ
- **ì–¸ì–´ê°„ ì¤‘ë³µ**: ë‹¤êµ­ì–´ ê°„ ë™ì¼ ID (ì •ìƒ ìƒí™©, ì •ë³´ì„±)

#### **1.2 íƒì§€ ì•Œê³ ë¦¬ì¦˜**
```javascript
// ì…ë ¥: ëª¨ë“  ì–¸ì–´ì˜ ë¬¸ì„œ ëª©ë¡
// ì¶œë ¥: ì¤‘ë³µ ë¶„ë¥˜ ê²°ê³¼
{
  sameLanguage: { "en": [["duplicate-id", [doc1, doc2]]] },
  filesystem: [["en:duplicate-id", [doc1, doc2]]],
  crossLanguage: [["shared-id", ["en", "ko"]]]
}
```

#### **1.3 ê²€ì‚¬ ëª…ë ¹ì–´**
```bash
# ì „ì²´ ì–¸ì–´ ê²€ì‚¬
node work-queue-cli.cjs check-duplicates
./wq check

# íŠ¹ì • ì–¸ì–´ ê²€ì‚¬  
node work-queue-cli.cjs check-duplicates en
./wq check en
```

### **2. ìë™ í•´ê²° ì‹œìŠ¤í…œ (Auto Resolution)**

#### **2.1 í•´ê²° ì „ëµ (Resolution Strategies)**

| ì „ëµ | ìš°ì„ ìˆœìœ„ | ì ìš© ë°©ì‹ | ì˜ˆì‹œ |
|------|----------|-----------|------|
| `path-hierarchy` | 1 | ì „ì²´ ê²½ë¡œ ê³„ì¸µ ë°˜ì˜ | `api/core/store.md` â†’ `api-core-store` |
| `category-prefix` | 2 | ì¹´í…Œê³ ë¦¬ ì ‘ë‘ì‚¬ ì¶”ê°€ | `store.md` â†’ `api-store` |
| `numeric-suffix` | 3 | ìˆ«ì ì ‘ë¯¸ì‚¬ ì¶”ê°€ | `store` â†’ `store-2` |

#### **2.2 ìë™ ì „ëµ ì„ íƒ**
```javascript
if (conflictType === 'filesystem') {
  strategy = 'path-hierarchy';  // íŒŒì¼ì‹œìŠ¤í…œ ì¶©ëŒ
} else {
  strategy = 'category-prefix'; // ë™ì¼ ì–¸ì–´ ì¶©ëŒ
}
```

#### **2.3 í•´ê²° ëª…ë ¹ì–´**
```bash
# ì‹œë®¬ë ˆì´ì…˜ (ë³€ê²½ ì—†ìŒ)
node work-queue-cli.cjs resolve-duplicates --dry-run
./wq resolve --dry-run

# ì‹¤ì œ í•´ê²°
node work-queue-cli.cjs resolve-duplicates en
./wq resolve en

# ì „ëµ ì§€ì •
./wq resolve --strategy=path-hierarchy
```

### **3. ì•ˆì „ì¥ì¹˜ ì‹œìŠ¤í…œ (Safety Measures)**

#### **3.1 ë³€ê²½ ì „ ê²€ì¦**
- **ì¶©ëŒ ì¬ê²€ì‚¬**: í•´ê²° í›„ì—ë„ ì¤‘ë³µì´ ë‚¨ì•„ìˆëŠ”ì§€ í™•ì¸
- **Fallback ì „ëµ**: ì‹¤íŒ¨ ì‹œ ë‹¤ë¥¸ ì „ëµìœ¼ë¡œ ìë™ ì „í™˜
- **ë¡¤ë°± ì¤€ë¹„**: ë³€ê²½ ì‚¬í•­ ì¶”ì  ë° ë³µêµ¬ ì •ë³´ ë³´ê´€

#### **3.2 ì‹¤í–‰ ëª¨ë“œ**
- **Dry Run**: `--dry-run` í”Œë˜ê·¸ë¡œ ë³€ê²½ ì—†ì´ ë¶„ì„ë§Œ ì‹¤í–‰
- **ì‹¤ì œ ì ìš©**: ê²€ì¦ ì™„ë£Œ í›„ íŒŒì¼ ì‹œìŠ¤í…œì— ì‹¤ì œ ë³€ê²½ ì ìš©
- **ì ì§„ì  ì ìš©**: ì¶©ëŒë³„ë¡œ ê°œë³„ ì²˜ë¦¬í•˜ì—¬ ë¶€ë¶„ ì‹¤íŒ¨ ì‹œì—ë„ ì¼ë¶€ í•´ê²°

---

## ğŸ”§ **ê¸°ìˆ  ëª…ì„¸ (Technical Specifications)**

### **ë°ì´í„° êµ¬ì¡°**

#### **ì¤‘ë³µ ì¶©ëŒ ê°ì²´**
```typescript
interface DuplicateConflict {
  type: 'sameLanguage' | 'filesystem';
  language?: string;           // sameLanguageì¸ ê²½ìš°
  conflictId?: string;         // ì¶©ëŒí•˜ëŠ” ID
  conflictKey?: string;        // filesystem ì¶©ëŒ í‚¤
  documents: DocumentInfo[];   // ì¶©ëŒí•˜ëŠ” ë¬¸ì„œë“¤
  severity: 'high' | 'medium' | 'low';
}
```

#### **í•´ê²° ê²°ê³¼ ê°ì²´**
```typescript
interface ResolutionResult {
  conflict: DuplicateConflict;
  strategy: string;           // ì‚¬ìš©ëœ í•´ê²° ì „ëµ
  changes: IdChange[];        // ì‹¤í–‰ëœ ë³€ê²½ ì‚¬í•­
  applied: boolean;           // ì‹¤ì œ ì ìš© ì—¬ë¶€
}

interface IdChange {
  document: DocumentInfo;
  oldId: string;
  newId: string;
  method: string;            // í•´ê²° ë°©ë²•
}
```

### **íŒŒì¼ ì‹œìŠ¤í…œ ë³€ê²½**

#### **ì˜í–¥ ë°›ëŠ” íŒŒì¼**
1. **priority.json**: `document.id` í•„ë“œ ì—…ë°ì´íŠ¸
2. **metadata.updated**: ë³€ê²½ ì¼ì‹œ ê¸°ë¡
3. **ë””ë ‰í† ë¦¬ ì´ë¦„**: IDì™€ ì¼ì¹˜í•˜ë„ë¡ ë³€ê²½

#### **ë³€ê²½ ì˜ˆì‹œ**
```bash
# Before
packages/llms-generator/data/en/store/
â”œâ”€â”€ priority.json          # {"document": {"id": "store"}}
â”œâ”€â”€ store-100.md
â””â”€â”€ store-200.md

# After (path-hierarchy ì ìš©)
packages/llms-generator/data/en/api-store/
â”œâ”€â”€ priority.json          # {"document": {"id": "api-store"}}
â”œâ”€â”€ api-store-100.md
â””â”€â”€ api-store-200.md
```

---

## ğŸ“Š **ì„±ëŠ¥ ë° ì œì•½ì‚¬í•­**

### **ì²˜ë¦¬ ì„±ëŠ¥**
- **ê²€ì‚¬ ì†ë„**: ~102ê°œ ë¬¸ì„œ < 2ì´ˆ
- **í•´ê²° ì†ë„**: ì¶©ëŒë‹¹ < 1ì´ˆ
- **ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰**: < 50MB

### **ì œì•½ì‚¬í•­**
- **ìµœëŒ€ ID ê¸¸ì´**: 100ì
- **í—ˆìš© ë¬¸ì**: `a-z0-9-`
- **ì˜ˆì•½ ID**: `["index", "readme", "main"]`
- **ë™ì‹œ ì‹¤í–‰**: ë‹¨ì¼ í”„ë¡œì„¸ìŠ¤ë§Œ ì§€ì›

### **í™•ì¥ì„±**
- **ì–¸ì–´ ì¶”ê°€**: ì„¤ì • ë³€ê²½ ì—†ì´ ìë™ ì§€ì›
- **ì „ëµ ì¶”ê°€**: `resolutionMethods` ê°ì²´ì— í•¨ìˆ˜ ì¶”ê°€
- **íŒŒì¼ í˜•ì‹**: `.md` ì™¸ ë‹¤ë¥¸ í™•ì¥ì ì§€ì› ê°€ëŠ¥

---

## ğŸ§ª **í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤**

### **ì‹œë‚˜ë¦¬ì˜¤ 1: ì •ìƒ ìƒí™©**
```bash
# ì…ë ¥: ì–¸ì–´ë³„ ê³ ìœ  IDë“¤
# ì˜ˆìƒ ì¶œë ¥: "No duplicate conflicts found!"
./wq check
```

### **ì‹œë‚˜ë¦¬ì˜¤ 2: ë™ì¼ ì–¸ì–´ ë‚´ ì¤‘ë³µ**
```bash
# ì‹œë®¬ë ˆì´ì…˜
mkdir -p data/en/test-duplicate-1 data/en/test-duplicate-2
echo '{"document":{"id":"duplicate"}}' > data/en/test-duplicate-1/priority.json
echo '{"document":{"id":"duplicate"}}' > data/en/test-duplicate-2/priority.json

# ê²€ì‚¬ ë° í•´ê²°
./wq check en          # ì¤‘ë³µ íƒì§€
./wq resolve --dry-run  # í•´ê²° ì‹œë®¬ë ˆì´ì…˜
./wq resolve en         # ì‹¤ì œ í•´ê²°
```

### **ì‹œë‚˜ë¦¬ì˜¤ 3: íŒŒì¼ì‹œìŠ¤í…œ ì¶©ëŒ**
```bash
# macOS/Windows: Store.md vs store.md
# ê²€ì‚¬ ì‹œ filesystem conflictë¡œ ë¶„ë¥˜
# path-hierarchy ì „ëµìœ¼ë¡œ í•´ê²°
```

---

## ğŸ”„ **ì›Œí¬í”Œë¡œìš° í†µí•©**

### **ê¸°ì¡´ ì‘ì—… íì™€ì˜ ì—°ë™**
```bash
# 1. ì¤‘ë³µ ê²€ì‚¬
./wq check

# 2. ì¤‘ë³µ í•´ê²° (í•„ìš”ì‹œ)
./wq resolve --dry-run    # ë¶„ì„
./wq resolve              # ì ìš©

# 3. ì •ìƒ ì‘ì—… ì§„í–‰
./wq next                 # ë‹¤ìŒ ì‘ì—… ëŒ€ìƒ
./wq c <id>               # ì‘ì—… ì™„ë£Œ
```

### **LLMS ìƒì„± ì›Œí¬í”Œë¡œìš°ì™€ì˜ í†µí•©**
```bash
# priority.json í…œí”Œë¦¿ ìƒì„±
node bulk-priority-generator.cjs en

# ì¤‘ë³µ ê²€ì‚¬ ë° í•´ê²°
./wq check
./wq resolve

# ê°œë³„ íŒŒì¼ ìƒì„±
node generate-individual-files.cjs

# LLMS ì§‘ê³„ íŒŒì¼ ìƒì„±
node dist/cli/index.js minimum en
```

---

## ğŸ“š **API ë¬¸ì„œ**

### **ì£¼ìš” ë©”ì„œë“œ**

#### **`checkDuplicates(language?: string)`**
- **ëª©ì **: ì¤‘ë³µ ID ê²€ì‚¬ ì‹¤í–‰
- **ì…ë ¥**: ì–¸ì–´ ì½”ë“œ (ì„ íƒì‚¬í•­, ê¸°ë³¸ê°’: ëª¨ë“  ì–¸ì–´)
- **ì¶œë ¥**: ì¤‘ë³µ ë¶„ë¥˜ ê²°ê³¼ ê°ì²´
- **ë¶€ì‘ìš©**: ì—†ìŒ (ì½ê¸° ì „ìš©)

#### **`resolveDuplicates(language?: string, options)`**
- **ëª©ì **: ì¤‘ë³µ ID ìë™ í•´ê²°
- **ì…ë ¥**: ì–¸ì–´ ì½”ë“œ, ì˜µì…˜ ê°ì²´
- **ì˜µì…˜**: `{dryRun: boolean, strategy: string}`
- **ì¶œë ¥**: í•´ê²° ê²°ê³¼ ê°ì²´
- **ë¶€ì‘ìš©**: dryRun=falseì‹œ íŒŒì¼ ì‹œìŠ¤í…œ ë³€ê²½

#### **`resolveConflict(conflict, strategy, dryRun)`**
- **ëª©ì **: ê°œë³„ ì¶©ëŒ í•´ê²°
- **ì…ë ¥**: ì¶©ëŒ ê°ì²´, ì „ëµëª…, ë“œë¼ì´ëŸ° ì—¬ë¶€
- **ì¶œë ¥**: ê°œë³„ í•´ê²° ê²°ê³¼
- **ë¶€ì‘ìš©**: í•´ê²° ë¡œì§ ì ìš©

---

## ğŸ¯ **ì„±ê³µ ê¸°ì¤€**

### **ê¸°ëŠ¥ì  ìš”êµ¬ì‚¬í•­**
- âœ… ëª¨ë“  ì¤‘ë³µ ìœ í˜• ì •í™•íˆ íƒì§€
- âœ… ìë™ í•´ê²° ì „ëµ 3ê°€ì§€ êµ¬í˜„
- âœ… Dry run ëª¨ë“œ ì§€ì›
- âœ… ì•ˆì „í•œ íŒŒì¼ ì‹œìŠ¤í…œ ë³€ê²½
- âœ… ëª…ë ¹ì¤„ ì¸í„°í˜ì´ìŠ¤ ì œê³µ

### **ë¹„ê¸°ëŠ¥ì  ìš”êµ¬ì‚¬í•­**  
- âœ… 2ì´ˆ ì´ë‚´ ê²€ì‚¬ ì™„ë£Œ (128ê°œ ë¬¸ì„œ)
- âœ… ì‚¬ìš©ì ì¹œí™”ì  ì¶œë ¥ í˜•ì‹
- âœ… ì˜¤ë¥˜ ì‹œ ëª…í™•í•œ ë©”ì‹œì§€
- âœ… ë˜í¼ ìŠ¤í¬ë¦½íŠ¸ ë‹¨ì¶• ëª…ë ¹ì–´
- âœ… í¬ê´„ì  ë„ì›€ë§ ì œê³µ

### **í’ˆì§ˆ ìš”êµ¬ì‚¬í•­**
- âœ… ê¸°ì¡´ ì‘ì—… í ê¸°ëŠ¥ê³¼ ì¶©ëŒ ì—†ìŒ
- âœ… ê¸°ì¡´ íŒŒì¼ êµ¬ì¡° ë³´ì¡´
- âœ… ë¡¤ë°± ê°€ëŠ¥í•œ ë³€ê²½ ì‚¬í•­
- âœ… ëª…í™•í•œ ë¡œê¹… ë° ë³´ê³ 
- âœ… í™•ì¥ ê°€ëŠ¥í•œ ì•„í‚¤í…ì²˜

---

## ğŸ”® **í–¥í›„ í™•ì¥ ê³„íš**

### **Phase 2 (ì˜ˆì •)**
- **ë°±ì—…/ë³µêµ¬ ì‹œìŠ¤í…œ**: ìë™ ë°±ì—… ë° ë³µêµ¬ ê¸°ëŠ¥
- **ëŒ€í™”í˜• í•´ê²°**: ìˆ˜ë™ ì„ íƒ ì˜µì…˜ ì œê³µ
- **ì„¤ì • íŒŒì¼**: `duplicate-config.json` ì§€ì›
- **ì›¹ ì¸í„°í˜ì´ìŠ¤**: GUI ê¸°ë°˜ ì¤‘ë³µ ê´€ë¦¬

### **Phase 3 (ê³ ë ¤ì‚¬í•­)**
- **ì˜ˆë°© ì‹œìŠ¤í…œ**: ì¤‘ë³µ ìƒì„± ë°©ì§€
- **ML ê¸°ë°˜ ì „ëµ**: íŒ¨í„´ í•™ìŠµ ê¸°ë°˜ í•´ê²°
- **í†µê³„ ëŒ€ì‹œë³´ë“œ**: ì¤‘ë³µ ë°œìƒ íŒ¨í„´ ë¶„ì„
- **CI/CD í†µí•©**: ìë™í™”ëœ ì¤‘ë³µ ê²€ì‚¬

ì´ ëª…ì„¸ì„œëŠ” êµ¬í˜„ëœ ê¸°ëŠ¥ì˜ ì •í™•í•œ ë™ì‘ ë°©ì‹ê³¼ ì‚¬ìš©ë²•ì„ ì™„ì „íˆ ë¬¸ì„œí™”í•˜ë©°, í–¥í›„ ìœ ì§€ë³´ìˆ˜ì™€ í™•ì¥ì˜ ê¸°ì¤€ì  ì—­í• ì„ í•©ë‹ˆë‹¤.